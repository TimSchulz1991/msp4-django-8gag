{% extends 'base.html' %}

{% block content %}

<div class="row">
    <div class="col-md-2">
        <h3>Topics</h3>
        <hr>
        <div>
            <a href="{% url 'home' %}">All topics</a>
        </div>
        {% for topic in topics %}
        <div>
            <a href="{% url 'home' %}?q={{topic.name}}">{{ topic.name }}</a>
        </div>
        {% endfor %}
        <div>
            <form action="{% url 'home' %}" method="GET">
                {% csrf_token %}
                <input type="text" name="q" placeholder="Search for memes...">
            </form>
        </div>
    </div>
    <div class="col-md-7">
        {% if posts %}
        {% for post in posts %}
        <div>
            <small>{{ post.topic }} - {{ post.created | timesince }} ago
                {% if request.user == post.author %}
                <a href="{% url 'post_delete' post.id %}"><button>Delete</button></a>
                {% endif %}
            </small>
            <a href="{% url 'post_view' post.id %}">
                <p>{{ post.title }}</p>
            </a>
            <img src="{{ post.image.url }}" alt="">
            <p><i class="fas fa-heart"></i>
                {{ post.number_of_likes }} </p>
            <p><i class="fas fa-comments"></i>{{ post.num_comments }}</p>
        </div>
        {% endfor %}
        {% else %}
        <div>
            <p>No Memes to see here ðŸ˜’</p>
        </div>
        {% endif %}
    </div>
    <div class="col-md-3">
        <div class="container d-flex justify-content-center align-items-center">
            {% if request.user.is_authenticated %}
            <div class="card text-center p-3">
                <div class="">
                    <h3>My profile</h3>
                </div>
                {% if request.user.profile.profile_image.url != None %}
                <img class="rounded-circle account-img mx-auto" src="{{request.user.profile.profile_image.url}}"
                    alt="A profile picture of the user">
                {% endif %}
                <div class="media-body mt-3">
                    <p class="">You are logged in as @{{request.user.username}}!</p>
                    {% if request.user.profile.bio %}
                    <p class="text-muted">{{request.user.profile.bio}}</p>
                    {% endif %}
                </div>
                <a href="{% url 'edit_profile' request.user.id %}"><button
                        class="btn btn-primary rounded-pill btn-profile">Add/change profile
                        info</button></a>
                <a href="{% url 'user_delete' request.user.id %}" class="delete-link mt-2">Delete my profile</a>
            </div>
        </div>
        {% else %}
        <div class="card text-center p-3">
            <p>Log in, if you want to create, comment on and like posts. As a logged in user, you can also add a picture to
                your profile and add a bio text.</p>
            <a href="{% url 'login' %}"><button
                    class="btn btn-primary rounded-pill btn-profile">Login/Register</button></a>
        </div>
        {% endif %}
    </div>
</div>

{% endblock %}